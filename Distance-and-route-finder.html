<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <title>Distance and Route Finder</title>
      <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
  <body>

  <h1 style="display:flex;flex-direction:row;justify-content:center;">Distance and Route Finder using Google Maps APIs</h1>

  <div style="display:flex;flex-direction:row;justify-content: space-between;width:40%;align-items: center;margin-left: 30%;">
    <div>
      <div>Origin address:</div>
      <input type="text" id="origin-add" placeholder="Enter origin address" value="84-86 Albert Road, Strathfield NSW, Australia" /> 
    </div>
    <div>
      <div>Destination address:</div>
      <input type="text" id="dest-add" placeholder="Enter destination address" value="Central Station, Pitt Street, Haymarket NSW, Australia" /> 
    </div>
  </div>

  <div>
    <p>Select Travel mode:</p>
    <input type="radio" id="travel-driving" name="travel-mode" value="DRIVING" checked>
      <label for="DRIVING">Driving</label>
      <input type="radio" id="travel-walking" name="travel-mode" value="WALKING">
      <label for="WALKING">Walking</label>
      <input type="radio" id="travel-bicycling" name="travel-mode" value="BICYCLING">
      <label for="BICYCLING">Bicycling</label>
      <input type="radio" id="travel-transit" name="travel-mode" value="TRANSIT">
      <label for="TRANSIT">Transit</label>
  </div>

  <div>
    <button id="show-route-btn">Show Route</button>
  </div>

  <div id="googleMap" style="width:100%;height:400px;margin-top: 50px;"></div>

  <script>

  myMap = () => {
  var mapProp= {
    center:new google.maps.LatLng(-33.8688, 151.2093),
    zoom:10,
  };

  var directionsService = new google.maps.DirectionsService();
  var directionsRenderer = new google.maps.DirectionsRenderer();
  var distanceService = new google.maps.DistanceMatrixService();

  var map = new google.maps.Map(document.getElementById("googleMap"),mapProp);
  directionsRenderer.setMap(map);
  
  var marker = new google.maps.Marker({position: new google.maps.LatLng(-33.8688, 151.2093)});
  marker.setMap(map);

  var origin = document.getElementById('origin-add');
  var autocompleteOrigin = new google.maps.places.Autocomplete(origin);

  var dest = document.getElementById('dest-add');
  var autocompleteDest = new google.maps.places.Autocomplete(dest);

  console.log(autocompleteOrigin, autocompleteDest)

  //map.setTilt(90);
  google.maps.event.addListener(map, 'click', (event) => {
    placeMarker(map, event.latLng);
  });

  placeMarker = (map, location) => {
    var marker = new google.maps.Marker({
      position: location,
      map: map
    });
  }

  document.getElementById('show-route-btn').addEventListener('click', () => {
    var start = document.getElementById('origin-add').value;
    var end = document.getElementById('dest-add').value;
    var selectedMode = document.querySelector('input[name="travel-mode"]:checked').value;
    console.log(selectedMode)
    var request = {
      origin: start,
      destination: end,
      travelMode: selectedMode
    };
    directionsService.route(request, (result, status) => {
      if (status == 'OK') {
        directionsRenderer.setDirections(result);
      }
    });

    const distanceRequest = {
      origins: [start],
      destinations: [end],
      travelMode: selectedMode,
      avoidHighways: false,
      avoidTolls: false,
    };

    distanceService.getDistanceMatrix(distanceRequest).then((response) => {
    // put response

    var distanceDetails = JSON.stringify(response)
    console.log(distanceDetails)
    console.log(distanceDetails.originAddresses)      
     
    })
    .catch((error) => {
      console.log(error);
    });;





  })



  }
  </script>

  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCFXE4uCIRzYbp6-4SkxOiggphLOW0U9FM&libraries=places&callback=myMap"></script>

  </body>
</html>